# Input: Graph G = (V, E), time budget b
# CH_down: Downward DAG from contraction hierarchy
# CH_up: Upward DAG from contraction hierarchy
# Listings: Set of listing nodes L ⊆ V
# Output:
#   L_down[v] = list of (listing, distance) pairs for all v ∈ V
#   L_up[v] = list of (hub, distance) pairs for all v ∈ V

# Initialize labels for all nodes
for v in V:
    L_down[v] = []
    L_up[v] = []


for listing in Listings:
    for (node, time) in Dijkstra(listing, CH_down):
        if time ≤ b:
            L_down[node].append((listing, time))


for v in V:
    for (hub, time) in Dijkstra(v, CH_up):
        if time ≤ b:
            L_up[v].append((hub, time))

for v in V:
    L_down[v].sort_ascending(attribute=time)
    L_up[v].sort_ascending(attribute=time)
